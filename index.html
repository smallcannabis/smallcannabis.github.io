<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Welcome to smallcracker&#39;s personal website</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Welcome to smallcracker&#39;s personal website">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Welcome to smallcracker&#39;s personal website">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="smallcracker">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Welcome to smallcracker's personal website" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Welcome to smallcracker&#39;s personal website</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-permutation" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/07/permutation/" class="article-date">
  <time class="dt-published" datetime="2021-03-06T16:00:00.000Z" itemprop="datePublished">2021-03-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/07/permutation/">generate permutation</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="全排列生成算法"><a href="#全排列生成算法" class="headerlink" title="全排列生成算法"></a>全排列生成算法</h1><h2 id="wikipedia上提供的一种方法"><a href="#wikipedia上提供的一种方法" class="headerlink" title="wikipedia上提供的一种方法"></a><em>wikipedia</em>上提供的一种方法</h2><p>这个方法可以以字典序生成一组数的全排列。方法非常简便，在14世纪由<em>Narayana Pandita</em>发现。</p>
<ol>
<li><p>Find the largest index k such that a[k] &lt; a[k + 1]. If no such index exists, the permutation is the last permutation.</p>
</li>
<li><p>Find the largest index l greater than k such that a[k] &lt; a[l].</p>
</li>
<li><p>Swap the value of a[k] with that of a[l].</p>
</li>
<li><p>Reverse the sequence from a[k + 1] up to and including the final element a[n].</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">1010</span>]; </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>* x,<span class="keyword">int</span>* y)</span></span>&#123;</span><br><span class="line">	*x^=*y^=*x^=*y;</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">		a[i]=i+<span class="number">1</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	<span class="keyword">int</span> k=<span class="number">0</span>,l=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(;;)&#123;</span><br><span class="line">		k=<span class="number">-1</span>,l=<span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=n<span class="number">-1</span><span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i]&lt;a[i+<span class="number">1</span>])&#123;</span><br><span class="line">				k=i;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(k==<span class="number">-1</span>)<span class="keyword">break</span>;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=n<span class="number">-1</span>;i&gt;k;i--)&#123;</span><br><span class="line">			<span class="keyword">if</span>(a[i]&gt;a[k])&#123;</span><br><span class="line">				l=i;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		swap(&amp;a[k],&amp;a[l]);</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=k+<span class="number">1</span>;i&lt;(k+<span class="number">1</span>+n<span class="number">-1</span>)/<span class="number">2</span>;i++)&#123;</span><br><span class="line">			swap(&amp;a[i],&amp;a[k+<span class="number">1</span>+n<span class="number">-1</span>-i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="然后是常规的递归生成方法"><a href="#然后是常规的递归生成方法" class="headerlink" title="然后是常规的递归生成方法"></a>然后是常规的递归生成方法</h2></li>
</ol>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> flag,a[<span class="number">100</span>];</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> t)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(t==n+<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,a[i]);</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">		<span class="keyword">return</span> ;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(!(flag&amp;(<span class="number">1</span>&lt;&lt;i)))&#123;</span><br><span class="line">			a[t]=i;</span><br><span class="line">			flag|=<span class="number">1</span>&lt;&lt;i;</span><br><span class="line">			dfs(t+<span class="number">1</span>);</span><br><span class="line">			flag^=<span class="number">1</span>&lt;&lt;i;			</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">	dfs(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/07/permutation/" data-id="cklylilot001chs3df5ev5ghx" data-title="generate permutation" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/" rel="tag">algorithm</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-1-Wire_Master" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/02/1-Wire_Master/" class="article-date">
  <time class="dt-published" datetime="2021-03-01T16:00:00.000Z" itemprop="datePublished">2021-03-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/02/1-Wire_Master/">1-Wire_Master</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h1><h1 id="例程"><a href="#例程" class="headerlink" title="例程"></a>例程</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">SysCtlPeripheralEnable(SYSCTL_PERIPH_ONEWIRE0);</span><br><span class="line"><span class="keyword">while</span>(!SysCtlPeripheralReady(SYSCTL_PERIPH_ONEWIRE0))&#123;&#125;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Initialize the module to use standard speed and read distance.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">OneWireInit(ONEWIRE0_BASE, (ONEWIRE_INIT_READ_STD | ONEWIRE_INIT_SPD_STD));</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Clear any pending interrupts.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">OneWireIntClear(ONEWIRE0_BASE, (ONEWIRE_INT_STUCK | ONEWIRE_INT_NO_SLAVE |ONEWIRE_INT_RESET_DONE |ONEWIRE_INT_OP_DONE));</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Enable the interrupts for operation done and the stuck bus error</span></span><br><span class="line"><span class="comment">// condition.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">OneWireIntEnable(ONEWIRE0_BASE, (ONEWIRE_INT_OP_DONE |</span><br><span class="line">ONEWIRE_INT_BUS_STUCK));</span><br><span class="line">IntEnable(INT_ONEWIRE0);</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Setup a four byte sequence and a bit count.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">ulData = ((<span class="number">0x01</span> &lt;&lt; <span class="number">24</span>) | (<span class="number">0x12</span> &lt;&lt; <span class="number">16</span>) | (<span class="number">0x10</span> &lt;&lt; <span class="number">8</span>) | <span class="number">0xcc</span>;</span><br><span class="line">ulBitCount = <span class="keyword">sizeof</span>(ulData) * <span class="number">8</span>;</span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Initiate a Reset and Write operation on the 1-Wire bus.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line">OneWireTransaction(ONEWIRE0_BASE, (ONEWIRE_OP_RESET | ONEWIRE_OP_WRITE),ulData, ulBitCount);</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/02/1-Wire_Master/" data-id="cklyliln10001hs3dhkr64gz4" data-title="1-Wire_Master" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">单片机</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-ESP8266" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/01/ESP8266/" class="article-date">
  <time class="dt-published" datetime="2021-02-28T16:00:00.000Z" itemprop="datePublished">2021-03-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/01/ESP8266/">esp8266</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="esp8266"><a href="#esp8266" class="headerlink" title="esp8266"></a>esp8266</h1><h2 id="esp8266的三种工作模式"><a href="#esp8266的三种工作模式" class="headerlink" title="esp8266的三种工作模式"></a>esp8266的三种工作模式</h2><ol>
<li>station 客户端模式，类似手机，小爱音箱等设备(client)</li>
<li>AP 接入点模式：类似于路由器(server),可以让其他设备访问</li>
<li>station+AP （客户端+接入点模式）<br><em>注意，配置esp8266的AT指令时每条指令后面都要加上回车再发送</em><h2 id="Station模式"><a href="#Station模式" class="headerlink" title="Station模式"></a>Station模式</h2></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/01/ESP8266/" data-id="cklylilnr000dhs3dbvd6f5zd" data-title="esp8266" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">单片机</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-bottom" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/01/bottom/" class="article-date">
  <time class="dt-published" datetime="2021-02-28T16:00:00.000Z" itemprop="datePublished">2021-03-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/01/bottom/">bottom</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="bottom"><a href="#bottom" class="headerlink" title="bottom"></a>bottom</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">bool</span> detection_queue[<span class="number">110</span>];</span><br><span class="line"><span class="keyword">int</span> detection_index=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> state=<span class="literal">false</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> duration[<span class="number">110</span>];</span><br><span class="line"><span class="keyword">int</span> message_index=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> tick=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> threshold=<span class="number">12</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">WTimer1AIntHandler</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> ulstatus = TimerIntStatus(WTIMER1_BASE,TIMER_TIMA_TIMEOUT);</span><br><span class="line">    TimerIntClear(WTIMER1_BASE, ulstatus);</span><br><span class="line">    <span class="keyword">int</span> ReadPin1 = GPIOPinRead(GPIO_PORTF_BASE, GPIO_PIN_4);<span class="comment">//检测</span></span><br><span class="line">    <span class="keyword">int</span> flag=((ReadPin1&amp;GPIO_PIN_4) != GPIO_PIN_4);</span><br><span class="line">    detection_queue[detection_index]=flag;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,sum=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=threshold;i++)sum+=(<span class="keyword">int</span>)detection_queue[detection_index-i];</span><br><span class="line">    <span class="keyword">if</span>(tick&gt;threshold)&#123;</span><br><span class="line">        <span class="keyword">if</span>(sum==threshold&amp;&amp;state==<span class="literal">false</span>)&#123;</span><br><span class="line">            state=<span class="literal">true</span>;</span><br><span class="line">            duration[message_index]=tick;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(sum==<span class="number">0</span>&amp;&amp;state==<span class="literal">true</span>)&#123;</span><br><span class="line">            state=<span class="literal">false</span>;</span><br><span class="line">            duration[message_index]=tick-duration[message_index];</span><br><span class="line">            UARTprintf(<span class="string">&quot;bottom up. message index is %d\nduration:%d\n&quot;</span>,message_index,duration[message_index]);</span><br><span class="line">            message_index++;</span><br><span class="line">            message_index%=<span class="number">110</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    tick++;</span><br><span class="line">    detection_index++;</span><br><span class="line">    detection_index%=<span class="number">110</span>;</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Configurebottom</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ROM_SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOF);</span><br><span class="line">    GPIODirModeSet(GPIO_PORTF_BASE, GPIO_PIN_4, GPIO_DIR_MODE_IN);</span><br><span class="line">    GPIOPadConfigSet(GPIO_PORTF_BASE, GPIO_PIN_4, GPIO_STRENGTH_2MA, GPIO_PIN_TYPE_STD_WPU);</span><br><span class="line">    SysCtlPeripheralEnable(SYSCTL_PERIPH_WTIMER1);</span><br><span class="line">    TimerConfigure(WTIMER1_BASE,TIMER_CFG_PERIODIC);</span><br><span class="line">    TimerLoadSet64(WTIMER1_BASE, clock/<span class="number">500</span>);</span><br><span class="line">    TimerIntRegister(WTIMER1_BASE, TIMER_A, WTimer1AIntHandler);</span><br><span class="line">    IntMasterEnable();</span><br><span class="line">    TimerIntEnable(WTIMER1_BASE, TIMER_TIMA_TIMEOUT);</span><br><span class="line">    IntEnable(INT_WTIMER1A);</span><br><span class="line">    TimerEnable(WTIMER1_BASE, TIMER_A);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Configurebottom();</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/03/01/bottom/" data-id="cklylilom0012hs3daix540dz" data-title="bottom" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">单片机</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-通用定时器" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/02/28/%E9%80%9A%E7%94%A8%E5%AE%9A%E6%97%B6%E5%99%A8/" class="article-date">
  <time class="dt-published" datetime="2021-02-27T16:00:00.000Z" itemprop="datePublished">2021-02-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/02/28/%E9%80%9A%E7%94%A8%E5%AE%9A%E6%97%B6%E5%99%A8/">通用定时器</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="通用定时器"><a href="#通用定时器" class="headerlink" title="通用定时器"></a>通用定时器</h1><h2 id="一、简介"><a href="#一、简介" class="headerlink" title="一、简介"></a>一、简介</h2><h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><p><img src="定时器功能.png" alt="timer"></p>
<h3 id="引脚"><a href="#引脚" class="headerlink" title="引脚"></a>引脚</h3><p><img src="通用定时器引脚.jpg" alt="pin"></p>
<h2 id="二、使用简介"><a href="#二、使用简介" class="headerlink" title="二、使用简介"></a>二、使用简介</h2><h3 id="1、定时器模式"><a href="#1、定时器模式" class="headerlink" title="1、定时器模式"></a>1、定时器模式</h3><p>这里有单次运行和连续运行模式。该单片机要想使用实时时钟模式，就要在ccp的偶数管引脚上接入一个32768hz的输入信号，所以这里不介绍RTC模式。<br><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">WTimer0AIntHandler</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> ulstatus = TimerIntStatus(WTIMER0_BASE,TIMER_TIMA_TIMEOUT);</span><br><span class="line">    TimerIntClear(WTIMER0_BASE, ulstatus);</span><br><span class="line">    UARTprintf(<span class="string">&quot;hello ,this is the WTIMER!\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ConfigureWTIMER</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SysCtlPeripheralEnable(SYSCTL_PERIPH_WTIMER0);</span><br><span class="line">    <span class="comment">//单次计时</span></span><br><span class="line">    TimerConfigure(WTIMER0_BASE,TIMER_CFG_ONE_SHOT);</span><br><span class="line">    <span class="comment">//周期计时</span></span><br><span class="line">    <span class="comment">//TimerConfigure(WTIMER0_BASE,TIMER_CFG_PERIODIC);</span></span><br><span class="line">    <span class="comment">//预设值设定</span></span><br><span class="line">    TimerLoadSet64(WTIMER0_BASE, clock*<span class="number">2</span>);</span><br><span class="line">    TimerIntRegister(WTIMER0_BASE, TIMER_A, WTimer0AIntHandler);</span><br><span class="line">    IntMasterEnable();</span><br><span class="line">    TimerIntEnable(WTIMER0_BASE, TIMER_TIMA_TIMEOUT);</span><br><span class="line">    IntEnable(INT_WTIMER0A);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//##############</span></span><br><span class="line"><span class="comment">//启动时钟</span></span><br><span class="line"><span class="comment">//##############</span></span><br><span class="line">TimerEnable(WTIMER0_BASE, TIMER_A);</span><br><span class="line"><span class="comment">//##############</span></span><br><span class="line"><span class="comment">//计数值读取</span></span><br><span class="line"><span class="comment">//##############</span></span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> timer_val = TimerValueGet64(WTIMER0_BASE);</span><br></pre></td></tr></table></figure></p>
<h3 id="捕捉模式"><a href="#捕捉模式" class="headerlink" title="捕捉模式"></a>捕捉模式</h3><h4 id="边沿计时模式"><a href="#边沿计时模式" class="headerlink" title="边沿计时模式"></a>边沿计时模式</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Timer2AIntHandler</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> s=TimerIntStatus(TIMER2_BASE,TIMER_CAPA_EVENT);</span><br><span class="line">    TimerIntClear(TIMER2_BASE,s);</span><br><span class="line">    UARTprintf(<span class="string">&quot;Captured Value: 0x%04X\n&quot;</span>, TimerValueGet(TIMER2_BASE, TIMER_A));</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ConfigureTIMERCCP</span><span class="params">()</span></span>&#123;</span><br><span class="line">    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOF);</span><br><span class="line">    SysCtlPeripheralEnable(SYSCTL_PERIPH_TIMER2);</span><br><span class="line">    GPIOPinConfigure(GPIO_PF4_T2CCP0);</span><br><span class="line">    GPIOPinTypeTimer(GPIO_PORTF_BASE, GPIO_PIN_4);</span><br><span class="line">    GPIOPadConfigSet(GPIO_PORTF_BASE, GPIO_PIN_4, GPIO_STRENGTH_2MA, GPIO_PIN_TYPE_STD_WPU);</span><br><span class="line">    TimerConfigure(TIMER2_BASE, TIMER_CFG_SPLIT_PAIR | TIMER_CFG_A_CAP_TIME_UP);</span><br><span class="line">    TimerControlEvent(TIMER2_BASE, TIMER_A, TIMER_EVENT_NEG_EDGE);</span><br><span class="line">    TimerLoadSet(TIMER2_BASE, TIMER_A, <span class="number">0x8FFF</span>);</span><br><span class="line">    TimerIntRegister(TIMER2_BASE, TIMER_A, Timer2AIntHandler);</span><br><span class="line">    IntMasterEnable();</span><br><span class="line">    TimerIntEnable(TIMER2_BASE, TIMER_CAPA_EVENT);</span><br><span class="line">    IntEnable(INT_TIMER2A);</span><br><span class="line">    TimerEnable(TIMER2_BASE,TIMER_A);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="PWM模式"><a href="#PWM模式" class="headerlink" title="PWM模式"></a>PWM模式</h3><p>优先使用集成的PWM</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/28/%E9%80%9A%E7%94%A8%E5%AE%9A%E6%97%B6%E5%99%A8/" data-id="cklylilpd001whs3dcx7l41lj" data-title="通用定时器" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">单片机</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-max30102 stm32代码" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/02/27/max30102%20stm32%E4%BB%A3%E7%A0%81/" class="article-date">
  <time class="dt-published" datetime="2021-02-26T16:00:00.000Z" itemprop="datePublished">2021-02-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/02/27/max30102%20stm32%E4%BB%A3%E7%A0%81/">max30102 stm32代码</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="max30102-stm32代码"><a href="#max30102-stm32代码" class="headerlink" title="max30102 stm32代码"></a>max30102 stm32代码</h1><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stm32f10x.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;usart.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;ultrasonic.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stm32f10x_gpio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stm32f10x_i2c.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;delay.h&quot;</span><span class="comment">//延时函数</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bsp_i2c_gpio.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*************************************************</span></span><br><span class="line"><span class="comment">函数: fputc(int ch, FILE *f)</span></span><br><span class="line"><span class="comment">功能: 重定向c库函数printf到USART1</span></span><br><span class="line"><span class="comment">参数: 无</span></span><br><span class="line"><span class="comment">返回: 无</span></span><br><span class="line"><span class="comment">**************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">fputc</span><span class="params">(<span class="keyword">int</span> ch, FILE *f)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        USART_SendData(USART1, (<span class="keyword">unsigned</span> <span class="keyword">char</span>) ch);</span><br><span class="line">        <span class="keyword">while</span> (!(USART1-&gt;SR &amp; USART_FLAG_TXE));</span><br><span class="line">        <span class="keyword">return</span> (ch);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*************************************************</span></span><br><span class="line"><span class="comment">函数: void main_init(void)</span></span><br><span class="line"><span class="comment">功能: main初始化</span></span><br><span class="line"><span class="comment">参数: 无</span></span><br><span class="line"><span class="comment">返回: 无</span></span><br><span class="line"><span class="comment">**************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">main_init</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        Usart_Init();</span><br><span class="line">        <span class="comment">//I2C1_GPIO_Config();</span></span><br><span class="line">        <span class="comment">//I2C1_Mode_config();</span></span><br><span class="line">        <span class="comment">//I2C1_Configuration();</span></span><br><span class="line">        bsp_InitI2C();</span><br><span class="line">        delay_init(<span class="number">72</span>);            <span class="comment">//延时初始化</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">extern</span> u8 <span class="title">max30102_Bus_Read</span><span class="params">(u8 Register_Address)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">void</span> <span class="title">max30102_init</span><span class="params">(<span class="keyword">void</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*************************************************</span></span><br><span class="line"><span class="comment">函数: int main(void)</span></span><br><span class="line"><span class="comment">功能: main主函数</span></span><br><span class="line"><span class="comment">参数: 无</span></span><br><span class="line"><span class="comment">返回: 无</span></span><br><span class="line"><span class="comment">**************************************************/</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        u8 temp_num=<span class="number">0</span>;</span><br><span class="line">        main_init();</span><br><span class="line">        </span><br><span class="line">        max30102_init();</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\r\n MAX30102  init  \r\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                delay_ms(<span class="number">1000</span>);            </span><br><span class="line">                max30102_init();</span><br><span class="line">                temp_num = max30102_Bus_Read(<span class="number">0x1f</span>);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;当前温度 = %d\r\n&quot;</span>,temp_num);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> max30102_WR_address 0xAE</span></span><br><span class="line"></span><br><span class="line"><span class="function">u8 <span class="title">max30102_Bus_Write</span><span class="params">(u8 Register_Address, u8 Word_Data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 采用串行EEPROM随机读取指令序列，连续读取若干字节 */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第1步：发起I2C总线启动信号 */</span></span><br><span class="line">        i2c_Start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第2步：发起控制字节，高7bit是地址，bit0是读写控制位，0表示写，1表示读 */</span></span><br><span class="line">        i2c_SendByte(max30102_WR_address | I2C_WR);        <span class="comment">/* 此处是写指令 */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第3步：发送ACK */</span></span><br><span class="line">        <span class="keyword">if</span> (i2c_WaitAck() != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">goto</span> cmd_fail;        <span class="comment">/* EEPROM器件无应答 */</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第4步：发送字节地址 */</span></span><br><span class="line">        i2c_SendByte(Register_Address);</span><br><span class="line">        <span class="keyword">if</span> (i2c_WaitAck() != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">goto</span> cmd_fail;        <span class="comment">/* EEPROM器件无应答 */</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/* 第5步：开始写入数据 */</span></span><br><span class="line">        i2c_SendByte(Word_Data);</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第6步：发送ACK */</span></span><br><span class="line">        <span class="keyword">if</span> (i2c_WaitAck() != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">goto</span> cmd_fail;        <span class="comment">/* EEPROM器件无应答 */</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 发送I2C总线停止信号 */</span></span><br><span class="line">        i2c_Stop();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;        <span class="comment">/* 执行成功 */</span></span><br><span class="line"></span><br><span class="line">cmd_fail: <span class="comment">/* 命令执行失败后，切记发送停止信号，避免影响I2C总线上其他设备 */</span></span><br><span class="line">        <span class="comment">/* 发送I2C总线停止信号 */</span></span><br><span class="line">        i2c_Stop();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">u8 <span class="title">max30102_Bus_Read</span><span class="params">(u8 Register_Address)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        u8  data;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第1步：发起I2C总线启动信号 */</span></span><br><span class="line">        i2c_Start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第2步：发起控制字节，高7bit是地址，bit0是读写控制位，0表示写，1表示读 */</span></span><br><span class="line">        i2c_SendByte(max30102_WR_address | I2C_WR);        <span class="comment">/* 此处是写指令 */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第3步：发送ACK */</span></span><br><span class="line">        <span class="keyword">if</span> (i2c_WaitAck() != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">goto</span> cmd_fail;        <span class="comment">/* EEPROM器件无应答 */</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第4步：发送字节地址， */</span></span><br><span class="line">        i2c_SendByte((<span class="keyword">uint8_t</span>)Register_Address);</span><br><span class="line">        <span class="keyword">if</span> (i2c_WaitAck() != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">goto</span> cmd_fail;        <span class="comment">/* EEPROM器件无应答 */</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第6步：重新启动I2C总线。下面开始读取数据 */</span></span><br><span class="line">        i2c_Start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第7步：发起控制字节，高7bit是地址，bit0是读写控制位，0表示写，1表示读 */</span></span><br><span class="line">        i2c_SendByte(max30102_WR_address | I2C_RD);        <span class="comment">/* 此处是读指令 */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第8步：发送ACK */</span></span><br><span class="line">        <span class="keyword">if</span> (i2c_WaitAck() != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">goto</span> cmd_fail;        <span class="comment">/* EEPROM器件无应答 */</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第9步：读取数据 */</span></span><br><span class="line">        &#123;</span><br><span class="line">                data = i2c_ReadByte();        <span class="comment">/* 读1个字节 */</span></span><br><span class="line"></span><br><span class="line">                i2c_NAck();        <span class="comment">/* 最后1个字节读完后，CPU产生NACK信号(驱动SDA = 1) */</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 发送I2C总线停止信号 */</span></span><br><span class="line">        i2c_Stop();</span><br><span class="line">        <span class="keyword">return</span> data;        <span class="comment">/* 执行成功 返回data值 */</span></span><br><span class="line"></span><br><span class="line">cmd_fail: <span class="comment">/* 命令执行失败后，切记发送停止信号，避免影响I2C总线上其他设备 */</span></span><br><span class="line">        <span class="comment">/* 发送I2C总线停止信号 */</span></span><br><span class="line">        i2c_Stop();</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">max30102_FIFO_Read</span><span class="params">(u8 Register_Address,u16  Word_Data[][<span class="number">2</span>],u8 count)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        u8 i=<span class="number">0</span>;</span><br><span class="line">        u8 no = count;</span><br><span class="line">        u8 data1, data2;</span><br><span class="line">        <span class="comment">/* 第1步：发起I2C总线启动信号 */</span></span><br><span class="line">        i2c_Start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第2步：发起控制字节，高7bit是地址，bit0是读写控制位，0表示写，1表示读 */</span></span><br><span class="line">        i2c_SendByte(max30102_WR_address | I2C_WR);        <span class="comment">/* 此处是写指令 */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第3步：发送ACK */</span></span><br><span class="line">        <span class="keyword">if</span> (i2c_WaitAck() != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">goto</span> cmd_fail;        <span class="comment">/* EEPROM器件无应答 */</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第4步：发送字节地址， */</span></span><br><span class="line">        i2c_SendByte((<span class="keyword">uint8_t</span>)Register_Address);</span><br><span class="line">        <span class="keyword">if</span> (i2c_WaitAck() != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">goto</span> cmd_fail;        <span class="comment">/* EEPROM器件无应答 */</span></span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第6步：重新启动I2C总线。下面开始读取数据 */</span></span><br><span class="line">        i2c_Start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第7步：发起控制字节，高7bit是地址，bit0是读写控制位，0表示写，1表示读 */</span></span><br><span class="line">        i2c_SendByte(max30102_WR_address | I2C_RD);        <span class="comment">/* 此处是读指令 */</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第8步：发送ACK */</span></span><br><span class="line">        <span class="keyword">if</span> (i2c_WaitAck() != <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">goto</span> cmd_fail;        <span class="comment">/* EEPROM器件无应答 */</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/* 第9步：读取数据 */</span></span><br><span class="line">        <span class="keyword">while</span> (no)</span><br><span class="line">        &#123;</span><br><span class="line">                data1 = i2c_ReadByte();        </span><br><span class="line">                i2c_Ack();</span><br><span class="line">                data2 = i2c_ReadByte();</span><br><span class="line">                i2c_Ack();</span><br><span class="line">                Word_Data[i][<span class="number">0</span>] = (((u16)data1 &lt;&lt; <span class="number">8</span>) | data2);  <span class="comment">//</span></span><br><span class="line"></span><br><span class="line">               </span><br><span class="line">                data1 = i2c_ReadByte();        </span><br><span class="line">                i2c_Ack();</span><br><span class="line">                data2 = i2c_ReadByte();</span><br><span class="line">                <span class="keyword">if</span>(<span class="number">1</span>==no)</span><br><span class="line">                        i2c_NAck();        <span class="comment">/* 最后1个字节读完后，CPU产生NACK信号(驱动SDA = 1) */</span></span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                        i2c_Ack();</span><br><span class="line">                Word_Data[i][<span class="number">1</span>] = (((u16)data1 &lt;&lt; <span class="number">8</span>) | data2);</span><br><span class="line"></span><br><span class="line">                no--;        </span><br><span class="line">                i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/* 发送I2C总线停止信号 */</span></span><br><span class="line">        i2c_Stop();</span><br><span class="line"></span><br><span class="line">cmd_fail: <span class="comment">/* 命令执行失败后，切记发送停止信号，避免影响I2C总线上其他设备 */</span></span><br><span class="line">        <span class="comment">/* 发送I2C总线停止信号 */</span></span><br><span class="line">        i2c_Stop();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> INTERRUPT_REG 0X00</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">max30102_init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        </span><br><span class="line">        max30102_Bus_Write(<span class="number">0x09</span>, <span class="number">0x0b</span>);  <span class="comment">//mode configuration : temp_en[3]      MODE[2:0]=010 HR only enabled    011 SP02 enabled</span></span><br><span class="line">        max30102_Bus_Write(<span class="number">0x01</span>, <span class="number">0xF0</span>); <span class="comment">//open all of interrupt</span></span><br><span class="line">        max30102_Bus_Write(INTERRUPT_REG, <span class="number">0x00</span>); <span class="comment">//all interrupt clear</span></span><br><span class="line">        max30102_Bus_Write(<span class="number">0x03</span>, <span class="number">0x02</span>); <span class="comment">//DIE_TEMP_RDY_EN</span></span><br><span class="line">        max30102_Bus_Write(<span class="number">0x21</span>, <span class="number">0x01</span>); <span class="comment">//SET   TEMP_EN</span></span><br><span class="line"></span><br><span class="line">        max30102_Bus_Write(<span class="number">0x0a</span>, <span class="number">0x47</span>); <span class="comment">//SPO2_SR[4:2]=001  100 per second    LED_PW[1:0]=11  16BITS</span></span><br><span class="line"></span><br><span class="line">        max30102_Bus_Write(<span class="number">0x0c</span>, <span class="number">0x47</span>);</span><br><span class="line">        max30102_Bus_Write(<span class="number">0x0d</span>, <span class="number">0x47</span>);</span><br><span class="line">                                                                                       </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/27/max30102%20stm32%E4%BB%A3%E7%A0%81/" data-id="cklylilow001fhs3d1pkp35ys" data-title="max30102 stm32代码" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">单片机</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-tasks" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/02/27/tasks/" class="article-date">
  <time class="dt-published" datetime="2021-02-26T16:00:00.000Z" itemprop="datePublished">2021-02-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/02/27/tasks/">tasks</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="系统外设"><a href="#系统外设" class="headerlink" title="系统外设"></a>系统外设</h1><ul>
<li>[ ] GPIO  </li>
<li>[ ] GPTM  </li>
<li>[ ] WDT  </li>
<li>[ ] μDMA  <h1 id="模拟外设"><a href="#模拟外设" class="headerlink" title="模拟外设"></a>模拟外设</h1></li>
<li>[ ] 模拟比较器  </li>
<li>[ ] 模拟数字转换器  <h1 id="串行通信外设"><a href="#串行通信外设" class="headerlink" title="串行通信外设"></a>串行通信外设</h1></li>
<li>[ ] UART  </li>
<li>[ ] SSI  </li>
<li>[ ] I2C  </li>
<li>[ ] CAN  </li>
<li>[ ] USB  <h1 id="运动控制外设"><a href="#运动控制外设" class="headerlink" title="运动控制外设"></a>运动控制外设</h1></li>
<li>[ ] PWM  </li>
<li><p>[ ] QEI  </p>
<h1 id="传感器"><a href="#传感器" class="headerlink" title="传感器"></a>传感器</h1><p>45款套件清单：</p>
</li>
<li><p>PS2摇杆游戏摇杆模块Joystick模块(bottom+ADC)</p>
</li>
<li>红外传感器接收模块(发射模块烧了。。)</li>
<li>激光头传感器模块(GPIO,5V)</li>
<li>温湿度传感器模块(GPIO,未完成)</li>
<li>红外发射传感器模块（烧了）</li>
<li>5V继电器模块(GPIO)</li>
<li>避障碍传感器智能小车红外传感器光电开关(GPIO,不好用)</li>
<li>手指侦测心跳模块(ADC,不好用)</li>
<li>高感度麦克风传感器模块(ADC或GPIO,貌似只对吹气管用)</li>
</ul>
<ol>
<li>金属触摸传感器模块</li>
<li>火焰传感器模块</li>
<li>3色LED模块</li>
<li>寻线传感器模块</li>
<li>线性磁力霍尔传感器</li>
<li>旋转编码器模块<br>?16. 有源蜂鸣器模块</li>
<li>魔术光杯模块</li>
<li>小型无源蜂鸣器模块<br>19.? 数字温度传感器模块</li>
<li>光折断器模块</li>
<li>温度传感器模块</li>
<li>双色LED共阴模块3MM</li>
<li>水银开光模块</li>
<li>霍尔磁力传感器模块</li>
<li>3色全彩LED smd模块</li>
<li>迷你磁簧模块</li>
<li>倾斜开关模块</li>
<li>七彩自动闪烁LED模块</li>
<li>按键开关模块</li>
<li>光敏电阻模块</li>
<li>震动开关模块</li>
<li>敲击传感器模块</li>
<li>温度传感器模块</li>
<li>类比霍尔磁性传感器</li>
<li>麦克风声音传感器模块</li>
<li>大磁簧模块</li>
<li>双色LED模块<br>38，面包板电源模块<br>39，超声波模块<br>40，MP1584EN降压模块<br>41，SD卡读写模块<br>42，陀螺仪模块<br>43，土壤模块<br>44，DS1302时钟模块<br>45，水位模块</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/27/tasks/" data-id="cklylilp8001shs3d4sv9aksb" data-title="tasks" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">单片机</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-IIC" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/02/26/IIC/" class="article-date">
  <time class="dt-published" datetime="2021-02-25T16:00:00.000Z" itemprop="datePublished">2021-02-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/02/26/IIC/">IIC</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="IIC"><a href="#IIC" class="headerlink" title="IIC"></a>IIC</h1><h2 id="一、IIC介绍"><a href="#一、IIC介绍" class="headerlink" title="一、IIC介绍"></a>一、IIC介绍</h2><p>I2C(Inter－Integrated Circuit)总线是80年代PHILIPS公司开发的两线式串行总线，如今已经成为芯片间低速串行通信的事实标准，被广泛使用在消费、控制类电子设备场合。这里的两个关键词两线和低速：<br><strong>两线</strong>意味着结构简单，<strong>低速</strong>意味着好实现，做电路的都知道速度越慢电路实现起来就越容易，而且协议方式也很优雅。所以这是一个简单、优雅、好实现、应用又广泛的电路协议。</p>
<h2 id="二、TM4C123GH6PM的I2C模块的特征"><a href="#二、TM4C123GH6PM的I2C模块的特征" class="headerlink" title="二、TM4C123GH6PM的I2C模块的特征"></a>二、TM4C123GH6PM的I2C模块的特征</h2><p>  内部集成电路（I2C）总线通过一个两线设计（串行数据线 SDA 和串行时钟线 SCL）来提供双向数据传输，并且与外部 I2C 器件诸如串行存储器（RAM 和 ROM），网络设备，LCD，音频发生器等联系。I2C 总线也可用于产品开发和制造的系统测试和诊断的目的。TM4C123GH6PM 微控制器提供与其他 I2C 总线上的设备交互（发送和接收）的能力。TM4C123GH6PM 控制器的 I2C 模块具有以下特点：</p>
<ul>
<li>可以用作master也可以用作slave<ul>
<li>两种情况下都支持发送和接受数据</li>
<li>同时支持主机和从机操作</li>
</ul>
</li>
<li>四个I2C模式<ul>
<li>主机发送模式</li>
<li>主机接收模式</li>
<li>从机发送模式</li>
<li>从机接收模式</li>
</ul>
</li>
<li>四个发送速率<ul>
<li>标准模式(100Kbps)</li>
<li>快速模式(400Kbps)</li>
<li>超快速模式(1bm’s)</li>
<li>高速模式(3.33bm’s)</li>
</ul>
</li>
<li>时钟低超时中断</li>
<li>双从地址能力</li>
<li>抗干扰</li>
<li>主机和从机中断的产生<ul>
<li>当主机发送或接收操作完成时（或因为错误终止时），产生中断</li>
<li>当从机发送数据或主机需要数据或检测到起始停止条件时，产生中断</li>
</ul>
</li>
<li>主机由仲裁和时钟同步，支持多主机，以及7位寻址模式<h2 id="三、结构图"><a href="#三、结构图" class="headerlink" title="三、结构图"></a>三、结构图</h2><img src="IIC结构图.png" alt="结构图"><h2 id="四、操作介绍"><a href="#四、操作介绍" class="headerlink" title="四、操作介绍"></a>四、操作介绍</h2><h3 id="1、主机操作"><a href="#1、主机操作" class="headerlink" title="1、主机操作"></a>1、主机操作</h3></li>
</ul>
<ol>
<li>当使用那些API操作I2C主机模块时，用户必须首先调用 <code>I2CMasterInitExpClk()</code>函数，这个函数可以设置总线速率、使能主机模块。  </li>
<li>首先设置从机地址 <code>I2CMasterSlaveAddrSet()</code>，这个函数还可以用于设置定义是发送（向从机写）还是接收（从从机读）。</li>
<li>然后如果当前总线是一个多主机主线的话，我们这个主机要先调用<code>l I2CMasterBusBusy()</code>函数。这个函数可以确定这个主线忙不忙。</li>
<li>最后，如果是想发送数据，就调用<code>I2CMasterDataPut()</code>函数，可以将要传送的数据存入I2C主机数据寄存器中。<code>I2CMasterControl()</code>控制I2C主机的状态（也就是发送一个指令），这样的指令就能操纵总线，发送开始序列，发送从机地址和方向。剩余部分的传送可以通过轮询或者中断的方法来进行。下面是指令的内容<br><img src="IIC_CMD.jpg" alt="IIC_CMD"><blockquote>
<p>关于轮询模式和中断模式的介绍  </p>
<ul>
<li>For the single send and receive cases, the polling method involves looping on the return fromI2CMasterBusy(). Once that function indicates that the I2C master is no longer busy, the bus transaction has been completed and can be checked for errors using I2CMasterErr(). If there are no errors, then the data has been sent or is ready to be read using I2CMasterDataGet().  </li>
<li>For the burst send and receive cases, the polling method also involves calling the I2CMasterControl() function for each byte transmitted or received (using either the I2C_MASTER_CMD_BURST_SEND_CONT or I2C_MASTER_CMD_BURST_RECEIVE_CONT commands), and for the last byte sent or received (using either the I2C_MASTER_CMD_BURST_SEND_FINISH or I2C_MASTER_CMD_BURST_RECEIVE_FINISH commands). If any error is detected during the burst transfer, the I2CMasterControl() function should be called using the appropriate stop command (I2C_MASTER_CMD_BURST_SEND_ERROR_STOP or I2C_MASTER_CMD_BURST_RECEIVE_ERROR_STOP).  </li>
<li>For the interrupt-driven transaction, the user must register an interrupt handler for the I2C devices and enable the I2C master interrupt; the interrupt occurs when the master is no longer busy. </li>
</ul>
<p>具体功能需结合数据手册的相应位查看<br>I2C_MASTER_CMD_BURST_SEND_START<br>起始信号+从机地址+应答+从机寄存器+应答<br>I2C_MASTER_CMD_BURST_SEND_CONT<br>数据+应答<br>I2C_MASTER_CMD_BURST_SEND_FINISH<br>I2C_MASTER_CMD_BURST_SEND_STOP<br>停止信号<br>I2C_MASTER_CMD_BURST_RECEIVE_START<br>起始信号+从机地址+应答+从机寄存器+应答<br>I2C_MASTER_CMD_BURST_RECEIVE_CONT<br>接收数据+应答<br>I2C_MASTER_CMD_BURST_RECEIVE_FINISH<br>停止信号<br>注意<br>I2C_MASTER_CMD_SINGLE_SEND<br>起始信号+从机地址+应答+数据+应答<br>与I2C_MASTER_CMD_BURST_SEND_CONT区别：多了起始信号+从机地址+应答<br> I2C_MASTER_CMD_SINGLE_RECEIVE<br>起始信号+从机地址+应答+接收数据+应答<br>同上！  </p>
<h3 id="2-从机模式"><a href="#2-从机模式" class="headerlink" title="2.从机模式"></a>2.从机模式</h3><p>当使用I2C从机模式时，用户需要调用<code>I2CSlaveInit()</code>函数。这个函数可以使能I2C从机模块，初始化从机地址。然后，根据操作的不同，用户可以调用<code>I2CSlaveDataPut()</code>或者<code>I2CSlaveDataGet()</code>来完成传输。或者可以通过中断来完成传输操作。中断用<code>I2CIntRegister()</code>来注册</p>
<h2 id="五、驱动包含在-driverlib-i2c-c-和-driverlib-i2c-h-里"><a href="#五、驱动包含在-driverlib-i2c-c-和-driverlib-i2c-h-里" class="headerlink" title="五、驱动包含在 driverlib/i2c.c 和 driverlib/i2c.h 里"></a>五、驱动包含在 driverlib/i2c.c 和 driverlib/i2c.h 里</h2><h2 id="六、例程"><a href="#六、例程" class="headerlink" title="六、例程"></a>六、例程</h2><p>这里先给出一个loopback的程序（无需连接外置I2C设备，自发自收）</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">uint32_t</span> pui32DataTx[NUM_I2C_DATA];</span><br><span class="line"><span class="keyword">uint32_t</span> pui32DataRx[NUM_I2C_DATA];</span><br><span class="line"><span class="keyword">uint32_t</span> ui32Index;</span><br><span class="line">SysCtlPeripheralEnable(SYSCTL_PERIPH_I2C0);</span><br><span class="line">SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOB);</span><br><span class="line">GPIOPinConfigure(GPIO_PB2_I2C0SCL);</span><br><span class="line">GPIOPinConfigure(GPIO_PB3_I2C0SDA);</span><br><span class="line">GPIOPinTypeI2CSCL(GPIO_PORTB_BASE, GPIO_PIN_2);</span><br><span class="line">GPIOPinTypeI2C(GPIO_PORTB_BASE, GPIO_PIN_3);</span><br><span class="line">I2CLoopbackEnable(I2C0_BASE);</span><br><span class="line">I2CMasterInitExpClk(I2C0_BASE, SysCtlClockGet(), <span class="literal">false</span>);</span><br><span class="line">I2CSlaveEnable(I2C0_BASE);</span><br><span class="line">I2CSlaveInit(I2C0_BASE, SLAVE_ADDRESS);</span><br><span class="line">I2CMasterSlaveAddrSet(I2C0_BASE, SLAVE_ADDRESS, <span class="literal">false</span>);</span><br><span class="line">pui32DataTx[<span class="number">0</span>] = <span class="string">&#x27;I&#x27;</span>;</span><br><span class="line">pui32DataTx[<span class="number">1</span>] = <span class="string">&#x27;2&#x27;</span>;</span><br><span class="line">pui32DataTx[<span class="number">2</span>] = <span class="string">&#x27;C&#x27;</span>;</span><br><span class="line"><span class="keyword">for</span>(ui32Index = <span class="number">0</span>; ui32Index &lt; NUM_I2C_DATA; ui32Index++)&#123;</span><br><span class="line">    pui32DataRx[ui32Index] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(ui32Index = <span class="number">0</span>; ui32Index &lt; NUM_I2C_DATA; ui32Index++)&#123;</span><br><span class="line">    I2CMasterDataPut(I2C0_BASE, pui32DataTx[ui32Index]);</span><br><span class="line">    I2CMasterControl(I2C0_BASE, I2C_MASTER_CMD_SINGLE_SEND);</span><br><span class="line">    <span class="keyword">while</span>(!(I2CSlaveStatus(I2C0_BASE) &amp; I2C_SLAVE_ACT_RREQ))&#123;&#125;</span><br><span class="line">    pui32DataRx[ui32Index] = I2CSlaveDataGet(I2C0_BASE);</span><br><span class="line">    <span class="keyword">while</span>(I2CMasterBusy(I2C0_BASE))&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(ui32Index = <span class="number">0</span>; ui32Index &lt; NUM_I2C_DATA; ui32Index++)&#123;</span><br><span class="line">    pui32DataRx[ui32Index] = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">I2CMasterSlaveAddrSet(I2C0_BASE, SLAVE_ADDRESS, <span class="literal">true</span>);</span><br><span class="line">I2CMasterControl(I2C0_BASE, I2C_MASTER_CMD_SINGLE_RECEIVE);</span><br><span class="line"><span class="keyword">while</span>(!(I2CSlaveStatus(I2C0_BASE) &amp; I2C_SLAVE_ACT_TREQ))&#123;&#125;</span><br><span class="line"><span class="keyword">for</span>(ui32Index = <span class="number">0</span>; ui32Index &lt; NUM_I2C_DATA; ui32Index++)&#123;</span><br><span class="line">    I2CSlaveDataPut(I2C0_BASE, pui32DataTx[ui32Index]);</span><br><span class="line">    I2CMasterControl(I2C0_BASE, I2C_MASTER_CMD_SINGLE_RECEIVE);</span><br><span class="line">    <span class="keyword">while</span>(!(I2CSlaveStatus(I2C0_BASE) &amp; I2C_SLAVE_ACT_TREQ))&#123;&#125;</span><br><span class="line">    pui32DataRx[ui32Index] = I2CMasterDataGet(I2C0_BASE);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</blockquote>
</li>
</ol>
<hr>
<h2 id="reference"><a href="#reference" class="headerlink" title="reference"></a>reference</h2><p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/31086959">简单优雅的总线协议——I2C</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38427678/article/details/94328208">TM4C123Gx单片机之—-I2C接口笔记</a><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43529046/article/details/90792308">TM4C123G 硬件I2C</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/26/IIC/" data-id="cklylilo7000nhs3dglhrb0wc" data-title="IIC" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">单片机</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-sg90" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/02/24/sg90/" class="article-date">
  <time class="dt-published" datetime="2021-02-23T16:00:00.000Z" itemprop="datePublished">2021-02-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/02/24/sg90/">sg90操作</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="sg90舵机操作模板"><a href="#sg90舵机操作模板" class="headerlink" title="sg90舵机操作模板"></a>sg90舵机操作模板</h1><h2 id="接线："><a href="#接线：" class="headerlink" title="接线："></a>接线：</h2><p>上线黄色为PWM输入信号；中线橙色接入电源正极；bai下线棕色接入电源负极。</p>
<h2 id="版本一：使用延时函数实现"><a href="#版本一：使用延时函数实现" class="headerlink" title="版本一：使用延时函数实现"></a>版本一：使用延时函数实现</h2><h2 id=""><a href="#" class="headerlink" title=""></a><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> angle;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt=<span class="number">0</span>,door=<span class="number">50</span>;</span><br><span class="line">    <span class="comment">//定义接入sg90舵机信号线的引脚</span></span><br><span class="line">    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOF);</span><br><span class="line">    GPIOPinTypeGPIOOutput(GPIO_PORTF_BASE, GPIO_PIN_2);</span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        door=angle*<span class="number">10</span>/<span class="number">9</span>+<span class="number">50</span>;</span><br><span class="line">        cnt++;</span><br><span class="line">        <span class="keyword">if</span>(cnt&gt;<span class="number">2000</span>)cnt=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(cnt==<span class="number">0</span>)GPIOPinWrite(GPIO_PORTF_BASE, GPIO_PIN_2, GPIO_PIN_2),UARTprintf(<span class="string">&quot;%d\n&quot;</span>,angle);</span><br><span class="line">        <span class="keyword">if</span>(cnt==door)GPIOPinWrite(GPIO_PORTF_BASE, GPIO_PIN_2, <span class="number">0</span>);</span><br><span class="line">        ROM_SysCtlDelay (clock/ <span class="number">300000</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></h2><h2 id="版本二：使用PWM实现"><a href="#版本二：使用PWM实现" class="headerlink" title="版本二：使用PWM实现"></a>版本二：使用PWM实现</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//首先配置PWM</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ConfigurePWM</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="comment">//系统时钟是50Mhz 这里进行64分频 得到7812500hzPWM频率</span></span><br><span class="line">    SysCtlPWMClockSet(SYSCTL_PWMDIV_64);</span><br><span class="line">    <span class="comment">//选择使用的引脚</span></span><br><span class="line">    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOF);</span><br><span class="line">    SysCtlPeripheralEnable(SYSCTL_PERIPH_PWM1);</span><br><span class="line">    GPIOPinTypePWM(GPIO_PORTF_BASE, GPIO_PIN_2);</span><br><span class="line">    <span class="comment">//配置信号分配</span></span><br><span class="line">    GPIOPinConfigure(GPIO_PF2_M1PWM6);</span><br><span class="line">    <span class="comment">//配置PWM发生器</span></span><br><span class="line">    PWMGenConfigure(PWM1_BASE, PWM_GEN_3, PWM_GEN_MODE_DOWN | PWM_GEN_MODE_NO_SYNC);</span><br><span class="line">    <span class="comment">//配置周期 表示50hz</span></span><br><span class="line">    PWMGenPeriodSet(PWM1_BASE, PWM_GEN_3, <span class="number">15625</span>);</span><br><span class="line">    <span class="comment">//配置占空比</span></span><br><span class="line">    PWMPulseWidthSet(PWM1_BASE, PWM_OUT_6, <span class="number">390</span>);</span><br><span class="line">    <span class="comment">//使能PWM模块1输出</span></span><br><span class="line">    PWMOutputState(PWM1_BASE, PWM_OUT_6_BIT, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">//使能PWM发生器</span></span><br><span class="line">    PWMGenEnable(PWM1_BASE, PWM_GEN_3);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//然后是旋转函数</span></span><br><span class="line"><span class="keyword">int</span> angle;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">()</span></span>&#123;</span><br><span class="line">    PWMPulseWidthSet(PWM1_BASE, PWM_OUT_6, <span class="number">625</span>*angle/<span class="number">72</span>+<span class="number">15625</span>/<span class="number">40</span>);</span><br><span class="line">    PWMGenEnable(PWM1_BASE, PWM_GEN_3);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/24/sg90/" data-id="cklylilp1001mhs3d2yg914m5" data-title="sg90操作" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">单片机</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-DHT11 温湿度传感器" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/31/DHT11%20%E6%B8%A9%E6%B9%BF%E5%BA%A6%E4%BC%A0%E6%84%9F%E5%99%A8/" class="article-date">
  <time class="dt-published" datetime="2021-01-30T16:00:00.000Z" itemprop="datePublished">2021-01-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/31/DHT11%20%E6%B8%A9%E6%B9%BF%E5%BA%A6%E4%BC%A0%E6%84%9F%E5%99%A8/">DHT11温湿度传感器</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="DHT11温湿度传感器"><a href="#DHT11温湿度传感器" class="headerlink" title="DHT11温湿度传感器"></a>DHT11温湿度传感器</h1><h2 id="一、外观"><a href="#一、外观" class="headerlink" title="一、外观"></a>一、外观</h2><p><img src="image-20210131194115189.png" alt="image-20210131194115189" style="zoom: 50%;" /></p>
<h2 id="二、参数特性"><a href="#二、参数特性" class="headerlink" title="二、参数特性"></a>二、参数特性</h2><p><img src="image-20210131194217788.png" alt="image-20210131194217788" style="zoom: 67%;" /></p>
<h2 id="三、引脚说明"><a href="#三、引脚说明" class="headerlink" title="三、引脚说明"></a>三、引脚说明</h2><p>s端是信号端，串行数据，负号端是负极，中间是正极，正极供电电压要求在3.5-5.5V之间</p>
<h2 id="四、数据格式"><a href="#四、数据格式" class="headerlink" title="四、数据格式"></a>四、数据格式</h2><p>一次传送40位数据，高位先出。格式规定如下</p>
<blockquote>
<p>8位湿度整数数据+8位湿度小数数据+8位温度整数数据+8位温度小数数据+8位校验位</p>
</blockquote>
<p><em>其中校验位数据的定义是前四组数据和的后8位</em></p>
<p><img src="C:\Users\smallcannabis\AppData\Roaming\Typora\typora-user-images\image-20210131195059673.png" alt="image-20210131195059673" style="zoom:50%;" /></p>
<h2 id="五、数据时序"><a href="#五、数据时序" class="headerlink" title="五、数据时序"></a>五、数据时序</h2><p>DHT11的总体通信流程。第一步：主机先发送开始信号，从机会返回一个相应信号进行应答。   第二步：主机信号线拉高准备接收数据。   第三部：开始接收数据（一次接收40位）。</p>
<h2 id="六、例程"><a href="#六、例程" class="headerlink" title="六、例程"></a>六、例程</h2><p>下面是温湿度传感器的相关代码：half success</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdbool.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;inc/hw_memmap.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;inc/hw_types.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;inc/hw_ints.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;inc/hw_memmap.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;inc/hw_pwm.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;inc/hw_timer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;driverlib/debug.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;driverlib/timer.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;driverlib/fpu.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;driverlib/gpio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;driverlib/pin_map.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;driverlib/rom.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;driverlib/rom_map.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;driverlib/sysctl.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;driverlib/uart.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;utils/uartstdio.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;driverlib/systick.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;driverlib/interrupt.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;driverlib/pwm.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> delay(ms) ROM_SysCtlDelay(clock*ms/3000)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> clock;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ConfigureUART</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> odd=<span class="literal">true</span>;</span><br><span class="line"><span class="keyword">int</span> last_cap=<span class="number">0</span>,cap_duration[<span class="number">1000</span>];</span><br><span class="line"><span class="keyword">bool</span> date[<span class="number">110</span>];</span><br><span class="line"><span class="keyword">int</span> gffg=<span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Timer2AIntHandler</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> ulstatus = TimerIntStatus(TIMER2_BASE, TIMER_CAPA_EVENT|TIMER_TIMA_TIMEOUT);</span><br><span class="line">    TimerIntClear(TIMER2_BASE, ulstatus);</span><br><span class="line">    odd=<span class="number">1</span>-odd;</span><br><span class="line">    <span class="keyword">if</span>(odd)&#123;</span><br><span class="line">        cap_duration[gffg++]=TimerValueGet(TIMER2_BASE, TIMER_A)-last_cap;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        if(cap_duration&lt;=0) cap_duration+=255*65536;</span></span><br><span class="line"><span class="comment">        UARTprintf(&quot;duration is &quot;);</span></span><br><span class="line"><span class="comment">        prt_f((float)cap_duration/40000000);</span></span><br><span class="line"><span class="comment">        UARTprintf(&quot;s.\n&quot;);</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;</span><br><span class="line">    last_cap=TimerValueGet(TIMER2_BASE, TIMER_A);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">prt_f</span><span class="params">(<span class="keyword">float</span> w)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(w&gt;<span class="number">0</span>)&#123;</span><br><span class="line">        UARTprintf(<span class="string">&quot;%d.&quot;</span>,(<span class="keyword">int</span>)w);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        UARTprintf(<span class="string">&quot;0.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> tem=(<span class="keyword">int</span>)(w*<span class="number">10000000</span>)%<span class="number">1000000</span>;</span><br><span class="line">    <span class="keyword">if</span>(tem&lt;<span class="number">1000000</span>)UARTprintf(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(tem&lt;<span class="number">100000</span>)UARTprintf(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(tem&lt;<span class="number">10000</span>)UARTprintf(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(tem&lt;<span class="number">1000</span>)UARTprintf(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(tem&lt;<span class="number">100</span>)UARTprintf(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(tem&lt;<span class="number">10</span>)UARTprintf(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(tem&lt;<span class="number">1</span>)UARTprintf(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    UARTprintf(<span class="string">&quot;%d&quot;</span>,tem);</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ConfigureDHT11</span><span class="params">()</span></span>&#123;</span><br><span class="line">    gffg=<span class="number">0</span>;</span><br><span class="line">    odd=<span class="literal">true</span>;</span><br><span class="line">    ROM_SysCtlDelay(clock*<span class="number">1500</span>/<span class="number">3000</span>);</span><br><span class="line">    <span class="comment">//UARTprintf(&quot;start to prepare....\n&quot;);</span></span><br><span class="line">    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOF);</span><br><span class="line">    GPIOPinTypeGPIOOutput(GPIO_PORTF_BASE, GPIO_PIN_4);</span><br><span class="line">    GPIOPinWrite(GPIO_PORTF_BASE, GPIO_PIN_4, <span class="number">0</span>);</span><br><span class="line">    ROM_SysCtlDelay(<span class="number">240000</span>);</span><br><span class="line">    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOF);</span><br><span class="line">    SysCtlPeripheralEnable(SYSCTL_PERIPH_TIMER2);</span><br><span class="line">    GPIOPinConfigure(GPIO_PF4_T2CCP0);</span><br><span class="line">    GPIOPinTypeTimer(GPIO_PORTF_BASE, GPIO_PIN_4);</span><br><span class="line">    GPIOPadConfigSet(GPIO_PORTF_BASE, GPIO_PIN_4, GPIO_STRENGTH_2MA, GPIO_PIN_TYPE_STD_WPU);</span><br><span class="line">    TimerPrescaleSet(TIMER2_BASE, TIMER_A, <span class="number">255</span>);</span><br><span class="line">    TimerConfigure(TIMER2_BASE, TIMER_CFG_SPLIT_PAIR | TIMER_CFG_A_CAP_TIME_UP);</span><br><span class="line">    TimerControlEvent(TIMER2_BASE, TIMER_A, TIMER_EVENT_BOTH_EDGES);</span><br><span class="line">    TimerLoadSet(TIMER2_BASE, TIMER_A, <span class="number">65535</span>);</span><br><span class="line">    TimerIntRegister(TIMER2_BASE, TIMER_A, Timer2AIntHandler);</span><br><span class="line">    IntMasterEnable();</span><br><span class="line">    TimerIntEnable(TIMER2_BASE, TIMER_CAPA_EVENT|TIMER_TIMA_TIMEOUT);</span><br><span class="line">    IntEnable(INT_TIMER2A);</span><br><span class="line">    TimerEnable(TIMER2_BASE,TIMER_A);</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">    delay(<span class="number">1500</span>);</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;gffg;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(cap_duration[i]&lt;=<span class="number">0</span>) cap_duration[i]+=<span class="number">255</span>*<span class="number">65536</span>;</span><br><span class="line">        date[i]=(cap_duration[i]&gt;<span class="number">2000</span>)?<span class="number">1</span>:<span class="number">0</span>;</span><br><span class="line">        <span class="comment">//UARTprintf(&quot;%d&quot;,date[i+1]==1?1:0);</span></span><br><span class="line">        <span class="comment">//if(i%8==0)UARTprintf(&quot;\n&quot;);</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        UARTprintf(&quot;duration is %d\n&quot;,cap_duration[i]);</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">        prt_f((float)cap_duration[i]/40000000);</span></span><br><span class="line"><span class="comment">        UARTprintf(&quot;s.\n&quot;);</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">float</span> hum=<span class="number">0</span>,temp=<span class="number">0</span>,cnt=<span class="number">128</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">16</span>;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(date[i+<span class="number">1</span>])hum+=cnt;</span><br><span class="line">        <span class="keyword">if</span>(date[i+<span class="number">1</span>+<span class="number">16</span>])temp+=cnt;</span><br><span class="line">        cnt/=<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//UARTprintf(&quot;\n&quot;);</span></span><br><span class="line">    <span class="keyword">if</span>(hum&lt;<span class="number">200</span>)&#123;</span><br><span class="line">        prt_f(hum);</span><br><span class="line">            UARTprintf(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            prt_f(temp);</span><br><span class="line">            UARTprintf(<span class="string">&quot;\n finish!\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> detection_queue[<span class="number">110</span>];</span><br><span class="line"><span class="keyword">int</span> detection_index=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">bool</span> state=<span class="literal">false</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> duration[<span class="number">110</span>];</span><br><span class="line"><span class="keyword">int</span> message_index=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">long</span> tick=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> threshold=<span class="number">12</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">WTimer1AIntHandler</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">long</span> ulstatus = TimerIntStatus(WTIMER1_BASE,TIMER_TIMA_TIMEOUT);</span><br><span class="line">    TimerIntClear(WTIMER1_BASE, ulstatus);</span><br><span class="line">    <span class="keyword">int</span> ReadPin1 = GPIOPinRead(GPIO_PORTF_BASE, GPIO_PIN_4);<span class="comment">//检测</span></span><br><span class="line">    <span class="keyword">int</span> flag=((ReadPin1&amp;GPIO_PIN_4) != GPIO_PIN_4);</span><br><span class="line">    detection_queue[detection_index]=flag;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,sum=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=threshold;i++)sum+=(<span class="keyword">int</span>)detection_queue[detection_index-i];</span><br><span class="line">    <span class="keyword">if</span>(tick&gt;threshold)&#123;</span><br><span class="line">        <span class="keyword">if</span>(sum==threshold&amp;&amp;state==<span class="literal">false</span>)&#123;</span><br><span class="line">            state=<span class="literal">true</span>;</span><br><span class="line">            duration[message_index]=tick;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(sum==<span class="number">0</span>&amp;&amp;state==<span class="literal">true</span>)&#123;</span><br><span class="line">            state=<span class="literal">false</span>;</span><br><span class="line">            duration[message_index]=tick-duration[message_index];</span><br><span class="line">            UARTprintf(<span class="string">&quot;bottom up. message index is %d\nduration:%d\n&quot;</span>,message_index,duration[message_index]);</span><br><span class="line">            message_index++;</span><br><span class="line">            message_index%=<span class="number">110</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    tick++;</span><br><span class="line">    detection_index++;</span><br><span class="line">    detection_index%=<span class="number">110</span>;</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Configurebottom</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ROM_SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOF);</span><br><span class="line">    GPIODirModeSet(GPIO_PORTF_BASE, GPIO_PIN_4, GPIO_DIR_MODE_IN);</span><br><span class="line">    GPIOPadConfigSet(GPIO_PORTF_BASE, GPIO_PIN_4, GPIO_STRENGTH_2MA, GPIO_PIN_TYPE_STD_WPU);</span><br><span class="line">    SysCtlPeripheralEnable(SYSCTL_PERIPH_WTIMER1);</span><br><span class="line">    TimerConfigure(WTIMER1_BASE,TIMER_CFG_PERIODIC);</span><br><span class="line">    TimerLoadSet64(WTIMER1_BASE, clock/<span class="number">500</span>);</span><br><span class="line">    TimerIntRegister(WTIMER1_BASE, TIMER_A, WTimer1AIntHandler);</span><br><span class="line">    IntMasterEnable();</span><br><span class="line">    TimerIntEnable(WTIMER1_BASE, TIMER_TIMA_TIMEOUT);</span><br><span class="line">    IntEnable(INT_WTIMER1A);</span><br><span class="line">    TimerEnable(WTIMER1_BASE, TIMER_A);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ConfigureEverything</span><span class="params">()</span></span>&#123;</span><br><span class="line">    FPUEnable();</span><br><span class="line">    FPULazyStackingEnable();</span><br><span class="line">    SysCtlClockSet(SYSCTL_SYSDIV_4 | SYSCTL_USE_PLL | SYSCTL_XTAL_16MHZ | SYSCTL_OSC_MAIN);</span><br><span class="line">    clock=SysCtlClockGet();</span><br><span class="line">    ConfigureUART();</span><br><span class="line">    <span class="comment">//Configurebottom();</span></span><br><span class="line">    <span class="keyword">for</span>(;;)&#123;</span><br><span class="line">        ConfigureDHT11();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ConfigureEverything();</span><br><span class="line">    UARTprintf(<span class="string">&quot;configuration finish.\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(;;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">ConfigureUART</span><span class="params">()</span></span>&#123;</span><br><span class="line">    ROM_SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOA);</span><br><span class="line">    ROM_SysCtlPeripheralEnable(SYSCTL_PERIPH_UART0);</span><br><span class="line">    ROM_GPIOPinConfigure(GPIO_PA0_U0RX);</span><br><span class="line">    ROM_GPIOPinConfigure(GPIO_PA1_U0TX);</span><br><span class="line">    ROM_GPIOPinTypeUART(GPIO_PORTA_BASE, GPIO_PIN_0 | GPIO_PIN_1);</span><br><span class="line">    UARTClockSourceSet(UART0_BASE, UART_CLOCK_PIOSC);</span><br><span class="line">    UARTStdioConfig(<span class="number">0</span>, <span class="number">115200</span>, <span class="number">16000000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/31/DHT11%20%E6%B8%A9%E6%B9%BF%E5%BA%A6%E4%BC%A0%E6%84%9F%E5%99%A8/" data-id="cklylilno000ahs3daj1971i7" data-title="DHT11温湿度传感器" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">单片机</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/" rel="tag">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/midi/" rel="tag">midi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/" rel="tag">test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" rel="tag">单片机</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/algorithm/" style="font-size: 10px;">algorithm</a> <a href="/tags/midi/" style="font-size: 10px;">midi</a> <a href="/tags/test/" style="font-size: 10px;">test</a> <a href="/tags/%E5%8D%95%E7%89%87%E6%9C%BA/" style="font-size: 20px;">单片机</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">January 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/03/07/permutation/">generate permutation</a>
          </li>
        
          <li>
            <a href="/2021/03/02/1-Wire_Master/">1-Wire_Master</a>
          </li>
        
          <li>
            <a href="/2021/03/01/ESP8266/">esp8266</a>
          </li>
        
          <li>
            <a href="/2021/03/01/bottom/">bottom</a>
          </li>
        
          <li>
            <a href="/2021/02/28/%E9%80%9A%E7%94%A8%E5%AE%9A%E6%97%B6%E5%99%A8/">通用定时器</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 smallcracker<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<!--script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>